<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>LiveMailChecker â€“ Real Gmail Bots</title>
<style>
:root {
  --bg:#f7f9fb;--card:#fff;--border:#ddd;
  --gray:#777;--text:#111;
  --inbox:#27ae60;--spam:#e74c3c;--promo:#8e44ad;
  font-family:"Inter",system-ui,sans-serif;
}
body{background:var(--bg);margin:0;color:var(--text);}
header{text-align:center;padding:1rem;background:var(--card);
  box-shadow:0 1px 3px rgba(0,0,0,.1);}
.search-bar{
  display:flex;justify-content:center;padding:.8rem;
  background:var(--card);
  box-shadow:0 1px 3px rgba(0,0,0,.05);
}
.search-bar input{
  width:60%;
  max-width:500px;
  padding:.5rem .8rem;
  border:1px solid var(--border);
  border-radius:6px;
  font-size:.9rem;
}
.connect-bar{
  display:flex;justify-content:center;gap:.5rem;flex-wrap:wrap;
  background:var(--card);
  padding:1rem;
  box-shadow:0 1px 3px rgba(0,0,0,.05);
}
.connect-bar input{
  padding:.5rem .8rem;
  border:1px solid var(--border);
  border-radius:6px;
  min-width:220px;
  font-size:.9rem;
}
.connect-bar button{
  background:#1a73e8;color:#fff;border:none;
  padding:.5rem 1rem;border-radius:6px;
  cursor:pointer;font-weight:600;
}
.connect-bar button:hover{background:#0d5bd6;}
.container{
  display:flex;
  flex-direction:column;
  gap:1rem;
  padding:1rem;
  max-width:100%;
  overflow-x:hidden;
}
.bot-row{
  display:flex;
  align-items:flex-start;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  box-shadow:0 2px 4px rgba(0,0,0,.05);
  overflow:hidden;
}
.bot-info{
  flex:0 0 220px;
  background:#fff;
  border-right:1px solid var(--border);
  padding:1rem;
  text-align:center;
  position:sticky;
  left:0;
  z-index:2;
}
.bot-info .icon{
  width:50px;height:50px;
  background:#d93025;color:#fff;
  font-weight:700;font-size:1.2rem;
  border-radius:10px;
  margin:0 auto .5rem;
  display:flex;align-items:center;justify-content:center;
}
.bot-info .email{
  font-size:.9rem;
  word-break:break-all;
}
.delete-btn{
  margin-top:.6rem;
  background:#e74c3c;
  color:#fff;
  border:none;
  border-radius:6px;
  padding:.3rem .7rem;
  font-size:.8rem;
  cursor:pointer;
}
.delete-btn:hover{background:#c0392b;}
.mail-scroll{
  display:flex;
  flex-wrap:nowrap;
  gap:.6rem;
  overflow-x:auto;
  padding:1rem;
  flex:1;
}
.mail-card{
  flex:0 0 280px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  box-shadow:0 1px 3px rgba(0,0,0,.05);
  padding:.7rem;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
}
.mail-line{font-size:.8rem;color:var(--gray);}
.mail-from{font-weight:600;font-size:.9rem;}
.mail-subject{font-size:.85rem;margin-top:.1rem;color:#222;}
.mail-bottom{
  display:flex;justify-content:space-between;align-items:center;
  margin-top:.4rem;
}
.badge{color:#fff;font-weight:600;font-size:.7rem;
  border-radius:6px;padding:.25rem .5rem;}
.badge.inbox{background:var(--inbox);}
.badge.spam{background:var(--spam);}
.badge.promo{background:var(--promo);}
.time{font-size:.7rem;color:var(--gray);}
::-webkit-scrollbar{height:8px;}
::-webkit-scrollbar-thumb{background:#ccc;border-radius:4px;}
::-webkit-scrollbar-track{background:#f0f0f0;}
footer{text-align:center;padding:1rem;color:var(--gray);font-size:.8rem;}
</style>
</head>
<body>
<header><h2>ðŸ“§ LiveMailChecker â€“ Real Gmail Bots</h2></header>

<!-- Search Bar -->
<div class="search-bar">
  <input id="searchInput" type="text" placeholder="Search by from, domain, subject, or IP..." />
</div>

<!-- Connect Bar -->
<div class="connect-bar">
  <input id="email" type="email" placeholder="Bot Gmail address" />
  <input id="pass" type="password" placeholder="App password" />
  <button id="connect">+ Add Bot</button>
</div>

<!-- Bots Container -->
<div class="container" id="dashboard"></div>

<footer>Type to filter â€¢ Add & remove bots â€¢ Each row scrolls horizontally</footer>

<script>
const dashboard=document.getElementById("dashboard");
const connectBtn=document.getElementById("connect");
const searchInput=document.getElementById("searchInput");

/* Fetch mails from backend */
async function fetchMails(botEmail, pass){
  try{
    const res=await fetch(`/api/fetch?email=${encodeURIComponent(botEmail)}&password=${encodeURIComponent(pass)}`);
    const data=await res.json();
    if(!data.emails)return [];
    return data.emails;
  }catch(e){
    console.error(e);
    return [];
  }
}

/* Create Bot Row */
async function createBotRow(email, pass){
  const mails=await fetchMails(email, pass);
  const row=document.createElement("div");
  row.className="bot-row";
  row.innerHTML=`
    <div class="bot-info">
      <div class="icon">M</div>
      <div class="email">${email}</div>
      <button class="delete-btn">Delete</button>
    </div>
    <div class="mail-scroll">
      ${mails.length===0
        ? `<div style='padding:1rem;color:gray;'>No recent emails</div>`
        : mails.map(m=>`
        <div class="mail-card"
          data-from="${(m.from||'').toLowerCase()}"
          data-subject="${(m.subject||'').toLowerCase()}"
          data-domain="${(m.domain||'').toLowerCase()}"
          data-ip="${(m.ip||'').toLowerCase()}">
          <div class="mail-from">${m.from}</div>
          <div class="mail-line"><strong>Email:</strong> ${m.from}</div>
          <div class="mail-subject"><strong>Subject:</strong> ${m.subject}</div>
          <div class="mail-line"><strong>Domain:</strong> ${m.domain}</div>
          <div class="mail-line"><strong>IP:</strong> ${m.ip}</div>
          <div class="mail-line"><strong>Received:</strong> ${new Date(m.received).toLocaleTimeString()} (${m.ago})</div>
          <div class="mail-bottom">
            <span class="badge inbox">Inbox</span>
            <span class="time">${m.ago}</span>
          </div>
        </div>`).join("")}
    </div>`;

  row.querySelector(".delete-btn").onclick=()=>{
    if(confirm(`Remove ${email}?`)){
      row.remove();
      alert(`${email} removed`);
    }
  };
  dashboard.appendChild(row);
}

/* Add bot */
connectBtn.onclick=()=>{
  const email=document.getElementById("email").value.trim();
  const pass=document.getElementById("pass").value.trim();
  if(!email||!pass){alert("Enter email and app password");return;}
  createBotRow(email, pass);
  document.getElementById("email").value="";
  document.getElementById("pass").value="";
};

/* Search filter */
searchInput.addEventListener("input",()=>{
  const query=searchInput.value.toLowerCase();
  document.querySelectorAll(".mail-card").forEach(card=>{
    const fields=[card.dataset.from,card.dataset.subject,card.dataset.domain,card.dataset.ip];
    card.style.display=fields.some(f=>f.includes(query))?"":"none";
  });
});
</script>
</body>
</html>

